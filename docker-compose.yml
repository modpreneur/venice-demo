version: '2'
services:

    basic_web:
        build:
          context: .
          dockerfile: docker/dev/Dockerfile
        volumes:
          - .:/var/app

    web:
      extends: basic_web
      links:
        - mysql:database
        - redis:redis
        - elasticsearch:elasticsearch
      ports:
        - "8888:80"
        - "9003:9003"
      expose:
        - "8888"

    mysql:
      image: mysql/mysql-server:5.7
      ports:
        - 3308:3306
      environment:
        - MYSQL_ROOT_PASSWORD=my-secret-pw -d
        - MYSQL_DATABASE=venice
        - MYSQL_USER=user
        - MYSQL_PASSWORD=pass

    redis:
      build:
        context: ./docker/redis/
      ports:
        - 6380:6379
      volumes:
        - ./docker/redis/redis.conf:/usr/local/etc/redis/redis.conf
      restart: always

    elasticsearch:
      image: elasticsearch:latest
    #  build: ./docker/elasticSearch
      ports:
    #    - 9300:9300
        - 9201:9200

networks:
  default:
    external:
      name: necktie_default
