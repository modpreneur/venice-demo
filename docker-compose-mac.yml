version: '2'

services:

php_fpm:
    build:
      context: .
      dockerfile: docker/phpFpm/dev/Dockerfile
    env_file: docker/.env
    links:
      - mysql:mysql
      - redis
      - elasticsearch
    ports:
      #php-fpm
      - "9092:9090"
      #supervisor
      - "9003:9003"
    expose:
      - "9003"
    volumes:
        - .:/var/app
        - /Volumes/RAM_Disk:/var/app/var/cache


  nginx:
        image: modpreneur/necktie-nginx-dev:0.3
        ports:
            - 8888:80
        links:
            - php_fpm
        volumes_from:
            - php_fpm
        volumes:
          - ./logs/nginx/:/var/log/nginx



  elasticsearch:
    extends:
      file: docker-compose.yml
      service: elasticsearch


  redis:
    extends:
      file: docker-compose.yml
      service: redis


  mysql:
    extends:
      file: docker-compose.yml
      service: mysql